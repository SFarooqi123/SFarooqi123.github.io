<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project 1 – Prokudin-Gorskii Colorization</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Source+Serif+4:opsz,wght@8..60,400;8..60,600&display=swap" rel="stylesheet">

  <style>
    :root{
      /* sibling palette to your Project 0 */
      --bg: #0b1113;
      --panel: #0f1719;
      --panel-2: #101c1f;
      --text: #e7f0f2;
      --muted: #9cb3b9;
      --accent: #18b0b0;
      --accent-2: #ffc857;
      --ring: #1e2a2d;
      --code: #0f2430;
      --radius: 18px;
      --maxw: 1000px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin: 0;
      font-family: 'Outfit', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 50% -220px, #0e1517 10%, var(--bg) 60%);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      line-height: 1.6;
    }

    .wrap{ max-width: var(--maxw); margin: 0 auto; padding: 42px 20px 80px; }

    header{ text-align:center; margin-bottom: 22px; }
    .eyebrow{
      display:inline-block; padding: 4px 10px; border-radius: 999px;
      background: rgba(24,176,176,.14); color: #b6f3f3; border: 1px solid rgba(24,176,176,.35);
      font-size: 12px; letter-spacing: .35px; text-transform: uppercase; margin-bottom: 10px;
    }
    h1{
      margin: 0 0 6px; font-size: clamp(26px, 4.6vw, 40px); font-weight: 700; letter-spacing: .2px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }
    .subtitle{ margin: 0; color: var(--muted); font-size: 14.5px; }

    /* Sections as cards */
    .card{
      background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
      border: 1px solid var(--ring); border-radius: var(--radius);
      padding: 18px 18px 22px; margin: 18px 0;
      box-shadow: 0 14px 32px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);
    }
    .card h2{ font-size: 20px; font-weight: 700; margin: 0 0 12px; color: #d9fdff; }
    .card h3{ font-size: 16px; margin: 10px 0 8px; color: #d9fdff; }
    .card p, .card ul{ color: var(--muted); font-size: 15px; margin: 8px 0; }

    /* Figures & galleries */
    .figgrid{ display:grid; gap:16px; }
    @media (min-width: 760px){
      .figgrid.cols-2{ grid-template-columns: 1fr 1fr; }
      .figgrid.cols-3{ grid-template-columns: 1fr 1fr 1fr; }
    }
    figure{ margin:0; background:#0e1517; border:1px solid #1b2629; border-radius:14px; overflow:hidden; }
    figure img{ display:block; width:100%; height:auto; }
    figcaption{
      padding: 10px 12px 12px;
      color:#b7c7cb; font-size: 13px; line-height:1.4;
      font-family: "Source Serif 4", ui-serif, Georgia, serif;
      border-top: 1px solid #172124; background: linear-gradient(180deg, #0f1618, #0b1214);
    }
    figcaption .name{ color:#e9fafc; font-weight:700; }
    figcaption .off{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace; color:#c6f3ff; font-weight:600; }

    /* Offsets table */
    .table-wrap{ overflow-x:auto; margin-top:10px; }
    table{
      width:100%; border-collapse: collapse; font-size: 14px; color: var(--text);
      background: #0e1517; border: 1px solid #1b2629; border-radius: 12px; overflow:hidden;
    }
    thead th{
      text-align:left; background:#0f181a; color:#d9fdff; border-bottom:1px solid #1b2629; padding:10px 12px;
    }
    tbody td{ padding:10px 12px; border-top:1px solid #142024; color:#cfe1e4; }
    tbody tr:hover{ background:#0f181a; }

    code, pre{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
      background: var(--code); color: #c6f3ff; border: 1px solid #18303d; border-radius: 10px; padding: 4px 7px;
    }
    pre{ padding:10px 12px; overflow:auto; }

    .footer{
      margin-top: 26px; display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap;
      color: var(--muted); font-size: 13px;
    }
    .footer a{ color: var(--accent-2); text-decoration:none; }
    .footer a:hover{ text-decoration:underline; }
  </style>
</head>
<body>
  <main class="wrap">
    <header>
      <span class="eyebrow">CS180 • Computer Vision & Computational Photography</span>
      <h1>Project 1: Prokudin-Gorskii Colorization</h1>
      <p class="subtitle">Registering historical B/G/R plates to reconstruct color images.</p>
    </header>

    <!-- EXPLANATION FIRST (like the example site) -->
    <section class="card" id="overview">
  <h2>Overview</h2>
  <p>
    Sergey Prokudin-Gorskii captured scenes through blue, green, and red filters on glass plates. This project reconstructs color images by aligning the Green and Red channels to the Blue channel, then stacking them into an RGB image. The focus is on implementing efficient alignment algorithms for both small and large images. 
  </p>
</section>

<section class="card" id="approach">
  <h2>Approach</h2>
  <h3>Small Images (Exhaustive Search)</h3>
  <ul>
    <li>Search window: integer shifts <code>(dy, dx) ∈ [-15, 15]</code>.</li>
    <li>Pre-processing: per-channel mean-centering; crop ~6% from each edge to avoid black plate borders.</li>
    <li>Transform: apply shifts with <code>np.roll</code>, but score only the internal (non-wrapped) region.</li>
    <li>Metric: <strong>Sum of Squared Differences (SSD)</strong> to minimize intensity differences.</li>
  </ul>

  <h3>Large Images (Image Pyramid)</h3>
  <ul>
    <li>Downsample by ½ manually (using <code>image[::2, ::2]</code>) until either four levels are built or the smallest dimension reaches ~64 px.</li>
    <li>Coarsest pass: at the lowest-resolution level, run an exhaustive search with a ±15 px window to get an initial shift.</li>
    <li>Propagate upward: move to the next finer level, double the shift to account for the 2× change in scale.</li>
    <li>Local refinement: refine the estimate in a small neighborhood of ±2 px around the doubled shift.</li>
    <li>Final alignment: apply the final shifts to the uncropped Green and Red channels and stack into RGB.</li>
  </ul>

  <h3>Problems & How I Addressed Them</h3>
  <ul>
    <li><strong>Edge/Border bias</strong> → crop ~6% of the interior before scoring to avoid artifacts caused by black plate borders.</li>
    <li><strong>Low texture / ambiguous SSD peaks</strong> → larger coarse window; pyramid levels; propagate-and-refine alignment.</li>
    <li><strong>Efficiency</strong> → manual downsampling and modular code for reusability.</li>
  </ul>

    </section>

    <!-- RESULTS SECTIONS (galleries first, then a consolidated offsets table) -->
    <section class="card" id="results-jpg">
      <h2>Results: Provided JPGs</h2>
      <div class="figgrid cols-2">
        <!-- Replace src and offsets as needed -->
        <figure>
          <img src="cathedral_output.jpg" alt="cathedral colorized" />
          <figcaption>
            <span class="name">cathedral.jpg</span> — G <span class="off">(5, 2)</span> | R <span class="off">(12, 3)</span>
          </figcaption>
        </figure>
        <figure>
          <img src="monastery_output.jpg" alt="monastery colorized" />
          <figcaption>
            <span class="name">monastery.jpg</span> — G <span class="off">(-3, 2)</span> | R <span class="off">(3, 2)</span>
          </figcaption>
        </figure>
        <figure>
          <img src="tobolsk_output.jpg" alt="tobolsk colorized" />
          <figcaption>
            <span class="name">tobolsk.jpg</span> — G <span class="off">(3, 2)</span> | R <span class="off">(6, 3)</span>
          </figcaption>
        </figure>
      </div>
    </section>

    <section class="card" id="results-tif">
  <h2>Results: Provided TIFs</h2>
  <div class="figgrid cols-2">
    <figure>
      <img src="church_output.jpg" alt="church colorized" />
      <figcaption><span class="name">church.tif</span> — G <span class="off">(25, 3)</span> | R <span class="off">(58, -5)</span></figcaption>
    </figure>
    <figure>
      <img src="harvesters_output.jpg" alt="harvesters colorized" />
      <figcaption><span class="name">harvesters.tif</span> — G <span class="off">(60, 16)</span> | R <span class="off">(124, 13)</span></figcaption>
    </figure>
    <figure>
      <img src="icon_output.jpg" alt="icon colorized" />
      <figcaption><span class="name">icon.tif</span> — G <span class="off">(41, 17)</span> | R <span class="off">(89, 23)</span></figcaption>
    </figure>
    <figure>
      <img src="italil_output.jpg" alt="italil colorized" />
      <figcaption><span class="name">italil.tif</span> — G <span class="off">(38, 21)</span> | R <span class="off">(77, 35)</span></figcaption>
    </figure>
    <figure>
      <img src="laketree_output.jpg" alt="laketree colorized" />
      <figcaption><span class="name">laketree.tif</span> — G <span class="off">(-30, -93)</span> | R <span class="off">(22, -83)</span></figcaption>
    </figure>
    <figure>
      <img src="lastochikino_output.jpg" alt="lastochikino colorized" />
      <figcaption><span class="name">lastochikino.tif</span> — G <span class="off">(-3, -2)</span> | R <span class="off">(76, -9)</span></figcaption>
    </figure>
    <figure>
      <img src="lugano_output.jpg" alt="lugano colorized" />
      <figcaption><span class="name">lugano.tif</span> — G <span class="off">(41, -17)</span> | R <span class="off">(93, -29)</span></figcaption>
    </figure>
    <figure>
      <img src="melons_output.jpg" alt="melons colorized" />
      <figcaption><span class="name">melons.tif</span> — G <span class="off">(82, 9)</span> | R <span class="off">(134, 3)</span></figcaption>
    </figure>
    <figure>
      <img src="self_portrait_output.jpg" alt="self portrait colorized" />
      <figcaption><span class="name">self_portrait.tif</span> — G <span class="off">(79, 29)</span> | R <span class="off">(134, 2)</span></figcaption>
    </figure>
    <figure>
      <img src="siren_output.jpg" alt="siren colorized" />
      <figcaption><span class="name">siren.tif</span> — G <span class="off">(49, -7)</span> | R <span class="off">(96, -25)</span></figcaption>
    </figure>
    <figure>
      <img src="three_generations_output.jpg" alt="three generations colorized" />
      <figcaption><span class="name">three_generations.tif</span> — G <span class="off">(53, 13)</span> | R <span class="off">(112, 10)</span></figcaption>
    </figure>
    <figure>
      <img src="view_output.jpg" alt="view colorized" />
      <figcaption><span class="name">view.tif</span> — G <span class="off">(75, -41)</span> | R <span class="off">(114, -68)</span></figcaption>
    </figure>
  </div>
</section>

    <section class="card" id="failures">
  <h2>Failure Cases & Explanations</h2>
  <p>
    While the alignment algorithm worked well for most images, certain challenging cases required additional considerations. Below are explanations for why earlier methods struggled and how adjustments were made to improve results.
  </p>
  <ul>
    <li>
      <strong>Edge/Border Bias:</strong> Earlier methods failed to crop enough of the interior region, causing alignment to be influenced by black plate borders. This was addressed by cropping ~6% of the interior before scoring.
    </li>
    <li>
      <strong>Low Texture / Ambiguous SSD Peaks:</strong> Images with low texture or repetitive patterns (e.g., <em>melons.tif</em>) caused the SSD metric to produce ambiguous peaks. Increasing the coarse search window and refining alignment at finer pyramid levels helped mitigate this issue.
    </li>
    <li>
      <strong>Inverted/Channel-Dependent Contrast:</strong> Images like <em>self_portrait.tif</em> exhibited intense color differences across channels, making raw-intensity SSD unreliable. Switching to edge-based alignment (using horizontal/vertical filters and magnitude maps) improved results.
    </li>
  </ul>
  <h3>Specific Failure Cases</h3>
  <ul>
    <li>
      <strong>self_portrait.tif:</strong> Intense channel-dependent contrast made SSD unreliable.<br />
      <strong>Solution:</strong> Used edge-based alignment (H/V 3×3 filters, magnitude maps).
    </li>
    <li>
      <strong>melons.tif:</strong> Repetitive patterns caused ambiguous SSD peaks.<br />
      <strong>Solution:</strong> Increased coarse search window and refined alignment at finer pyramid levels.
    </li>
  </ul>
</section>

    <!-- Your own chosen images -->
    <section class="card" id="own">
      <h2>Additional Images (My Picks from Prokudin-Gorskii)</h2>
      <div class="figgrid cols-2">
        <figure>
          <img src="view_output.jpg" alt="mills colorized" />
          <figcaption><span class="name">view.tif</span> — G <span class="off">(75, -41)</span> | R <span class="off">(114, -68)</span></figcaption>
        </figure>
        <figure>
          <img src="laketree_output.jpg" alt="dome colorized" />
          <figcaption><span class="name">laketree.tif</span> — G <span class="off">(-30, -93)</span> | R <span class="off">(22, -83)</span></figcaption>
        </figure>
        <figure>
          <img src="lakes_output.jpg" alt="boat colorized" />
          <figcaption><span class="name">lake.jpg</span> — G <span class="off">(4, -1)</span> | R <span class="off">(7, 1)</span></figcaption>
        </figure>
         <figure>
          <img src="rocks_output.jpg" alt="boat colorized" />
          <figcaption><span class="name">rocks.jpg</span> — G <span class="off">(4, 4)</span> | R <span class="off">(9, 6)</span></figcaption>
        </figure>
        
      </div>
    </section>

    <div class="footer">
      <div>© Samar Farooqi • Project 1</div>
      <div><a href="../index.html">← Back to Portfolio</a></div>
    </div>
  </main>
</body>
</html>
